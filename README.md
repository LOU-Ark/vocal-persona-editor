# vocal-persona-editor
インタラクティブ・ペルソナ・エディター

AIを活用して詳細なキャラクターペルソナを作成、管理、対話できる先進的なWebアプリケーションです。React、TypeScript、そしてGoogle Gemini APIで構築されており、作家、ゲーム開発者、そして趣味で創作活動を行う人々がキャラクターに命を吹き込むための包括的なスイートを提供します。

## ✨ 機能

### ペルソナ管理
- **作成と編集:** キャラクターの名前や役割から、性格や世界観に至るまで、ペルソナのあらゆる側面を定義・修正するための豊富なインターフェース。
- **ペルソナ一覧:** 作成したすべてのペルソナを、アクセスしやすいクリーンなカードベースのレイアウトで表示。
- **削除:** 不要になったペルソナを簡単に削除。

### AIによる作成と調整
- **トピックから作成:** 「陽気な宇宙海賊の船長」のようなコンセプトを提示するだけで、AIがGoogle検索で情報を収集し、詳細なパラメータを持つ完全なペルソナを生成します。
- **ファイルから作成:** `.txt`形式のキャラクターシートをアップロードすると、AIがそれを知的に解析し、ペルソナのパラメータを自動的に入力します。
- **AIサマリー:** 定義されたパラメータに基づいて、ペルソナの魅力的で物語性のある要約を生成。要約を編集し、その変更をAIにパラメータへ反映させることも可能です。
- **AIチャットで調整:** AIアシスタントとの対話を通じてペルソナを微調整。「彼女をもっと皮肉屋にして」「彼にエンジニアリングの経歴を与えて」といった指示を出すだけで、パラメータがリアルタイムで更新されるのを確認できます。

### 対話とテスト
- **テストチャット:** エディター内の専用チャットパネルで、ペルソナの口調や性格を即座にテスト。
- **プロダクションチャット:** フルスクリーンのチャットインターフェースに切り替え、作成した任意のペルソナとより長い会話を楽しめます。
- **テキスト読み上げ (TTS):** キャラクターの応答を音声で聞き、命を吹き込みます。高品質なカスタム音声合成のために、Fish Audio APIと連携。
- **音声管理:** TTS機能のために、複数のカスタム音声を追加・管理。
- **音声入力 (STT):** マイクを使ってペルソナと話すことで、より自然で没入感のあるチャット体験を実現。

### バージョン管理
- **履歴追跡:** ペルソナを保存するたびに新しいバージョンが作成されます。AIが変更点の簡潔な要約（例：「性格をより皮肉なものに調整」）を生成します。
- **変更の復元:** バージョン履歴を簡単に閲覧し、ワンクリックでペルソナを以前の状態に戻すことができます。

## 🛠️ 技術スタック

- **フロントエンド:** React, TypeScript, Tailwind CSS
- **バックエンド:** Vercel Serverless Functions (Node.js)
- **AIモデル:** Google Gemini API (`gemini-2.5-flash`) - コンテンツ生成、チャット、JSONスキーマ適用、Google検索グラウンディングに使用
- **テキスト読み上げ (TTS):** Fish Audio API (安全なサーバーレスプロキシ経由)
- **音声入力 (STT):** Web Speech API
- **依存関係:** CDN (`esm.sh`) 経由で読み込み - `npm install` は不要です。

## 🚀 はじめに

このプロジェクトは、サーバーレス関数をサポートするブラウザベースの開発環境、またはプロキシ関数を実行できるローカルサーバーで直接実行するように設計されています。

### 1. APIキーの設定

これは最も重要なステップです。有効なAPIキーがないと、アプリケーションは機能しません。アプリケーションを実行する環境（Vercelなど）で、以下の環境変数を設定してください。

- **Google Gemini APIキー (必須):**
  - **変数名:** `API_KEY`
  - **説明:** アプリケーションのすべてのAI機能に必要です。このキーはサーバー側でのみ使用され、ブラウザに公開されることはありません。

- **Fish Audio TTS (任意):**
  - **変数名:** `FISH_AUDIO_DEFAULT_TOKEN`
  - **説明:** (推奨) デフォルトTTS音声を使用する場合のFish Audio APIトークン。
  
- **デフォルトTTS音声 (任意):**
  - **変数名:** `VITE_FISH_AUDIO_DEFAULT_VOICE_ID`
  - **変数名:** `VITE_FISH_AUDIO_DEFAULT_NAME`
  - **説明:** アプリケーションに組み込むデフォルト音声のIDと表示名。これらを設定すると、ユーザーは手動で設定しなくてもすぐにTTS機能を利用できます。

ユーザーが手動でカスタム音声を追加する機能は引き続き利用可能です。その場合、認証情報はブラウザのローカルストレージに保存されます。

### 2. アプリケーションの実行

このプロジェクトは`api/`ディレクトリ内のファイルをサーバーレス関数として提供できる環境（Vercel, Netlifyなど）を想定しています。

互換性のある環境であれば、`index.html`を開くだけでアプリケーションがロードされます。

## 📁 ファイル構成

```
.
├── api/
│   ├── config.ts         # 公開設定をフロントエンドに提供するAPI
│   ├── gemini.ts         # Google Gemini APIのための安全なサーバーレスプロキシ
│   └── tts.ts            # Fish Audio TTS APIのためのサーバーレスプロキシ
├── components/
│   ├── App.tsx             # メインのアプリケーションコンポーネントと状態管理
│   ├── icons.tsx           # SVGアイコンコンポーネント
│   ├── Loader.tsx          # ローディングスピナーコンポーネント
│   ├── PersonaEditorModal.tsx # ペルソナ作成/編集とAIツールのためのコアモーダル
│   ├── PersonaList.tsx     # 作成された全ペルソナのグリッド表示
│   ├── ProductionChat.tsx  # メインのチャットインターフェース
│   └── VoiceManagerModal.tsx # TTS音声認証情報を管理するUI
├── services/
│   └── geminiService.ts    # バックエンドAPIプロキシを呼び出すためのクライアントサイドサービス
├── types.ts                # アプリケーションのTypeScript型定義
├── index.html              # メインのHTMLエントリーポイント
├── index.tsx               # Reactアプリケーションのエントリーポイント
└── metadata.json           # アプリケーションのメタデータ（権限など）
```
