# Vocal Persona Editor

AIを活用して詳細なキャラクターペルソナを作成、管理、対話できる先進的なWebアプリケーションです。React、TypeScript、そしてGoogle Gemini APIで構築されており、作家、ゲーム開発者、そして趣味で創作活動を行う人々がキャラクターに命を吹き込むための包括的なツールスイートを提供します。

## ✨ 機能

### ペルソナ管理
- **作成と編集:** キャラクターの名前や役割から、性格や世界観に至るまで、ペルソナのあらゆる側面を定義・修正するための豊富なインターフェース。
- **ペルソナ一覧:** 作成したすべてのペルソナを、アクセスしやすいクリーンなカードベースのレイアウトで表示。
- **削除とエクスポート:** 不要になったペルソナを簡単に削除したり、バックアップや共有のためにJSON形式でエクスポートしたりできます。

### AIによる作成と調整
- **トピックから作成:** 「陽気な宇宙海賊の船長」のようなコンセプトを提示するだけで、AIがGoogle検索で情報を収集し、詳細なパラメータを持つ完全なペルソナを生成します。
- **ファイルから作成:** `.txt`または`.json`形式のキャラクターシートをアップロードすると、AIがそれを知的に解析し、ペルソナのパラメータを自動的に入力します。
- **AIサマリー:** 定義されたパラメータに基づいて、ペルソナの魅力的で物語性のある要約を生成。要約を編集し、その変更をAIにパラメータへ反映させることも可能です。
- **MBTI性格分析:** AIがペルソナの特性を分析し、MBTI（マイヤーズ・ブリッグス・タイプ指標）に基づいた性格プロファイルを生成。レーダーチャートで視覚的に表示します。

### 対話とテスト
- **テストチャット:** エディター内の専用チャットパネルで、ペルソナの口調や性格を即座にテスト。
- **プロダクションチャット:** フルスクリーンのチャットインターフェースに切り替え、作成した任意のペルソナとより長い会話を楽しめます。
- **テキスト読み上げ (TTS):** キャラクターの応答を音声で聞き、命を吹き込みます。高品質なカスタム音声合成のために、Fish Audio APIと連携。
- **音声管理:** TTS機能のために、複数のカスタム音声を追加・管理。
- **音声入力 (STT):** マイクを使ってペルソナと話すことで、より自然で没入感のあるチャット体験を実現。

### バージョン管理
- **履歴追跡:** ペルソナを保存するたびに新しいバージョンが作成されます。AIが変更点の簡潔な要約（例：「性格をより皮肉なものに調整」）を生成します。
- **変更の復元:** バージョン履歴を簡単に閲覧し、ワンクリックでペルソナを以前の状態に戻すことができます。

## 🛠️ 技術スタック

- **フロントエンド:** React, TypeScript, Tailwind CSS (CDN経由)
- **バックエンド (本番):** Vercel Serverless Functions (Node.js)
- **バックエンド (開発):** Express (ローカル開発用サーバー)
- **AIモデル:** Google Gemini API - コンテンツ生成、チャット、JSONスキーマ適用、Google検索グラウンディングに使用
- **テキスト読み上げ (TTS):** Fish Audio API (安全なサーバーレスプロキシ経由)
- **音声入力 (STT):** Web Speech API
- **開発ツール:** Vite, tsx, concurrently

## 🚀 はじめに

### 1. APIキーの設定

アプリケーションのAI機能を有効にするには、APIキーの設定が不可欠です。プロジェクトのルートに`.env`ファイルを作成し、以下の環境変数を設定してください。

- **Google Gemini APIキー (必須):**
  - `API_KEY=YOUR_GOOGLE_API_KEY`
  - **説明:** アプリケーションのすべてのAI機能に必要です。このキーはサーバー側でのみ使用され、ブラウザに公開されることはありません。

- **Fish Audio TTS (任意):**
  - `FISH_AUDIO_DEFAULT_TOKEN=YOUR_FISH_AUDIO_TOKEN`
  - `VITE_FISH_AUDIO_DEFAULT_VOICE_ID=default_voice_id`
  - `VITE_FISH_AUDIO_DEFAULT_NAME="デフォルト音声名"`
  - **説明:** アプリケーションにデフォルトのTTS音声を組み込む場合に使用します。

### 2. 依存関係のインストール

このプロジェクトは、開発用のバックエンドサーバーとフロントエンドのビルドツールにNode.jsとnpmを使用します。

```bash
npm install
```

### 3. アプリケーションの実行

以下のコマンドで、Vite開発サーバーとバックエンドAPIサーバーを同時に起動します。

```bash
npm run dev
```

- フロントエンドは `http://localhost:5173` (またはViteが指定したポート) で利用可能になります。
- バックエンドAPIは `http://localhost:3001` で実行されます。

## 📁 ファイル構成

```
.
├── api/
│   ├── config.ts         # 公開設定をフロントエンドに提供するAPI
│   ├── gemini.ts         # Google Gemini APIのための安全なサーバーレスプロキシ
│   ├── server.ts         # ローカル開発用のExpress APIサーバー
│   └── tts.ts            # Fish Audio TTS APIのためのサーバーレスプロキシ
├── components/
│   ├── PersonaEditorModal.tsx # ペルソナ作成/編集とAIツールのためのコアモーダル
│   ├── PersonaList.tsx     # 作成された全ペルソナのグリッド表示
│   ├── ProductionChat.tsx  # メインのチャットインターフェース
│   └── ...               # その他のUIコンポーネント
├── services/
│   └── geminiService.ts    # バックエンドAPIを呼び出すためのクライアントサイドサービス
├── App.tsx                 # メインのアプリケーションコンポーネントと状態管理
├── index.html              # メインのHTMLエントリーポイント
├── index.tsx               # Reactアプリケーションのエントリーポイント
├── package.json            # プロジェクトの依存関係とスクリプト
└── README.md               # このファイル
```